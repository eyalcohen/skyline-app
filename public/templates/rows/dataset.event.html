<%
  var gravatar = 'https://www.gravatar.com/avatar/'
      + this.model.get('author').gravatar + '?s=26&d=mm';

  var num_channels = this.model.get('channels_cnt');
  if (num_channels === 1) {
    num_channels += ' channel';
  } else {
    num_channels += ' channels';
  }

  var source = '';
  if (this.model.get('source')) {
    source += this.model.get('source');
  }
  var link = this.model.get('sourceLink');
  if (link) {
    if (source !== '') {
      source = '<a class="event-source" href="' + link + '" target="_blank"><i class="icon-link"></i>' + source + '</a>';
    } else {
      source = '<a class="event-source" href="' + link + '" target="_blank"><i class="icon-link"></i>' + link + '</a>';
    }
  }

  var tags = this.model.get('tags') || [];
%>

<div class="event-title">
  <a href="/<%= this.model.get('author').username %>" class="title navigate">
    <%= this.model.formatAuthorFor(this.app.profile.user) %></a> added a 
    <a href="/<%= this.model.get('author').username %>/<%= this.model.id %>" class="title navigate">dataset</a> 
    with <%= num_channels %>.
  <% if (source !== '') { %>
    <%= source %>
  <% } %>
</div>
<span class="event-title-text">
  <a href="/<%= this.model.get('author').username %>/<%= this.model.id %>" class="title-large navigate">
    <%= this.model.formatTitle() %>
  </a>
</span>
<span class="event-timeline-label event-timeline-label-first">
  <i class="icon-database"></i>
</span>
<% if (this.model.get('channels').length !== 0) { %>
  <ul class="event-channels">
    <% _.each(this.model.get('channels'), _.bind(function (c) { %>
      <li id="<%= c.channelName %>" data-id="<%= c.id %>">
        <a href="/<%= this.model.get('author').username %>/<%= this.model.id %>/<%= c.channelName %>"
            class="navigate">
          <span class="event-timeline-label">
            <i class="icon-chart-line"></i>
          </span>
          <span class="event-timeline-label-text"></span>
          <span class="event-channel-name">
            <%= c.humanName %>
          </span>
          <div class="event-channel-svg"></div>
          <p class="event-channel-note">
            
          </p>
          <% if (this.app.profile.user &&
              this.model.get('author').id === this.app.profile.user.id) { %>
            <a href="javascript:;" class="event-channel-delete">
              <i class="icon-cancel"></i>
            </a>
          <% } %>
        </a>
      </li>
    <% }, this)); %>
  </ul>
<% } %>
<% if (this.model.get('description') || tags.length > 0) { %>
  <p class="event-description">
    <% if (this.model.get('description')) { %>
      <%= this.model.description() %>
    <% } %>
    <% if (tags.length > 0) { %>
      <span class="event-tags">
        Tags: 
        <% _.each(tags, function(t, i) { %>
          <%= t %><% if (i < tags.length - 1) { %>,<% } %>
        <% }); %>
      </span>
    <% } %>
  </p>
<% } %>
<div class="event-info">
  Added <a href="/<%= this.model.get('author').username %>/<%= this.model.id %>"
        class="navigate"><time class="created" 
        datetime="<%= this.model.get('created') %>" 
        title="<%= this.model.get('created') %>">
    <%= this.model.get('created') %>
  </time></a>
  <% if (this.app.profile.user &&
      this.model.get('author').id === this.app.profile.user.id) { %>
    <span class="info-divider">&nbsp;&middot;&nbsp;</span>
    <a href="javascript:;" class="info-delete">Delete</a>
  <% } %>
</div>
<div class="event-comments"></div>
