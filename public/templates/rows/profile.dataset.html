<%

  // Gravatar
  var size = this.parentView.modal ? 15: 20;
  var gravatar = 'https://www.gravatar.com/avatar/'
      + this.model.get('author').gravatar + '?s=' + size + '&d=mm';
  var parent_gravatar = this.model.get('parent') ? 'https://www.gravatar.com/avatar/'
      + this.model.get('parent').author.gravatar + '?s=' + size + '&d=mm': null;

  var numChannels = this.model.get('meta').channels ?
      this.model.get('meta').channels.length: this.model.get('meta').channel_cnt;

%>

<td class="main-cell">
  <img src="<%= gravatar %>" width="<%= size %>" height="<%= size %>" class="profile-dataset-avatar" />
  <% if (this.model.get('parent')) { %>
    <img src="<%= parent_gravatar %>" width="<%= size %>" height="<%= size %>" class="profile-dataset-parent-avatar" />
  <% } %>
  <span class="profile-item-title">
    <% if (this.model.get('parent')) { %>
      <i class="icon-database"><i class="icon-split"></i></i>
    <% } else { %>
      <i class="<%= this.model.get('public') === false ? 'icon-lock': 'icon-database' %>"></i>
    <% } %>
    <%= this.model.get('title') %>
    <% if (this.model.get('parent') && this.parentView.modal) { %>
      <span>
        (forked from <a href="/<%= this.model.get('parent').author.username %>/<%= this.model.get('parent').id %>"
        class="navigate<%= this.model.get('parent').public === false ? ' locked': '' %>">
        <i class="icon-database"></i><%= this.model.get('parent').title %></a>)
      </span>
    <% } %>
  </span>
  <p class="profile-item-stats">
    <% if (this.model.get('parent') && !this.parentView.modal) { %>
      <span>
        Forked from <a href="/<%= this.model.get('parent').author.username %>/<%= this.model.get('parent').id %>"
        class="navigate<%= this.model.get('parent').public === false ? ' locked': '' %>">
        <i class="icon-database"></i><%= this.model.get('parent').title %></a>
      </span>
    <% } %>
  </p>
</td>
<td class = "main-cell-vis-wrap">
  <div class="main-cell-vis">
    <table>
    </table>
  </div>
</td>
<td>
  <%= numChannels %>
</td>
<td>
  <time class="created" 
      datetime="<%= this.model.get('updated') %>" 
      title="<%= this.model.get('updated') %>">
    <%= this.model.get('updated') %>
  </time>
</td>
<% if (!this.parentView.modal) { %>
  <% if (this.app.profile.user &&
      this.model.get('author').id === this.app.profile.user.id) { %>
    <td class="profile-item-delete">
      <i class="icon-cancel"></i>
    </td>
  <% } else { %>
    <td class="profile-item-delete-empty">&nbsp;</td>
  <% } %>
<% } %>
